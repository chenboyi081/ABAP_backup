<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZPP044_DEFINE</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZPP044_DEFINE</b></font>
<hr>
<pre width="100">
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>
<font color ="#0000FF">*&  包括                ZPP044_DEFINE</font>
<font color ="#0000FF">*&---------------------------------------------------------------------*</font>

<font color ="#0000FF">************************************************************************</font>
<font color ="#0000FF">* 引用表</font>
<font color ="#0000FF">************************************************************************</font>
tables:mast,sscrfields.

<font color ="#0000FF">************************************************************************</font>
<font color ="#0000FF">* 类型字段</font>
<font color ="#0000FF">************************************************************************</font>
TYPES: BEGIN OF ty_EXCEL,
<font color ="#0000FF">*    ZXH TYPE I,</font>
     MATNR TYPE mast-MATNR,   "物料号
     WERKS TYPE mast-WERKS,   "工厂
<font color ="#0000FF">*     STLAN TYPE mast-STLAN,   "BOM 用途</font>
     STLAL TYPE mast-STLAL,   "可选的 BOM
END OF ty_EXCEL.

TYPES:BEGIN OF TY_CHECKMSG,
     ZXH TYPE I,
     MATNR TYPE mast-MATNR,   "物料号
     WERKS TYPE mast-WERKS,   "工厂
<font color ="#0000FF">*     STLAN TYPE mast-STLAN,   "BOM 用途</font>
     STLAL TYPE mast-STLAL,   "可选的 BOM
    ERR_MSG(100) TYPE C,    "错误文本  "错误信息
  END OF  TY_CHECKMSG.


<font color ="#0000FF">************************************************************************</font>
<font color ="#0000FF">*全局变量</font>
<font color ="#0000FF">************************************************************************</font>
DATA:G_ERROR(255) TYPE C. "保存错误文本
DATA:G_FLAG TYPE C.   "值为 ‘X’ 导入文本存在错误
<font color ="#0000FF">*** OLE EXCLE定义</font>
DATA: G_SHEET TYPE OLE2_OBJECT,
      G_ACTIVESHEET TYPE OLE2_OBJECT,
      G_NEWSHEET TYPE OLE2_OBJECT,
      G_APPL TYPE OLE2_OBJECT,
      G_WORK TYPE OLE2_OBJECT,
      G_CELL TYPE OLE2_OBJECT.

DATA  td_exclude TYPE TABLE OF sy-ucomm.
DATA:  WL_ANSWER  TYPE C.
<font color ="#0000FF">************************************************************************</font>
<font color ="#0000FF">*内表&工作区</font>
<font color ="#0000FF">************************************************************************</font>
DATA  GT_RAW TYPE TRUXS_T_TEXT_DATA.
DATA: LT_EXCEL TYPE STANDARD TABLE OF ty_EXCEL,
      LW_EXCEL TYPE ty_EXCEL.

DATA: LT_CHECKMSG TYPE STANDARD TABLE OF TY_CHECKMSG,
     LW_CHECKMSG TYPE TY_CHECKMSG.

<font color ="#0000FF">***alv相关内表定义</font>
DATA:GT_FCAT  TYPE LVC_T_FCAT,
     W_FCAT   TYPE LVC_S_FCAT,
     W_LAYOUT TYPE LVC_S_LAYO.

<font color ="#0000FF">************************************************************************</font>
<font color ="#0000FF">* 字段符声明</font>
<font color ="#0000FF">************************************************************************</font>
FIELD-SYMBOLS: &lt;FS_EXCEL&gt; TYPE ty_EXCEL.


<font color ="#0000FF">************************************************************************</font>
<font color ="#0000FF">* 常量定义</font>
<font color ="#0000FF">************************************************************************</font>


<font color ="#0000FF">*----------------------------------------------------------------------*</font>
<font color ="#0000FF">* 宏定义</font>
<font color ="#0000FF">*----------------------------------------------------------------------*</font>
DEFINE MARCO.
  CLEAR W_FCAT.
  &1 = &1 + 1.
  W_FCAT-COL_POS = &1.
  W_FCAT-FIELDNAME = &2.
  W_FCAT-COLTEXT = &3.
  W_FCAT-KEY = &4.

  APPEND W_FCAT TO GT_FCAT.
END-OF-DEFINITION.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 702
</font>
</body>
</html>
